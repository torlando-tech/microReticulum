# Requirements Archive: v1.2 Stability Complete

**Archived:** 2026-01-24
**Status:** SHIPPED

This is the archived requirements specification for v1.2.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: microReticulum v1.2 Stability Complete

**Defined:** 2026-01-24
**Core Value:** Reliable firmware operation for extended periods without crashes or performance degradation.

## v1.2 Requirements

Complete all P2 and P3 stability issues from the v1 audit. Each requirement maps to a backlog issue.

### Memory Allocation (P2)

- [x] **MEM-M1**: Bytes newData uses make_shared pattern (single allocation)
- [x] **MEM-M2**: PacketReceipt default constructor defers allocation until use
- [x] **MEM-M3**: Persistence uses JsonDocument (ArduinoJson 7 API fully migrated)

### LVGL Thread-Safety (P2)

- [x] **CONC-M1**: SettingsScreen constructor/destructor uses LVGL_LOCK
- [x] **CONC-M2**: ComposeScreen constructor/destructor uses LVGL_LOCK
- [x] **CONC-M3**: AnnounceListScreen constructor/destructor uses LVGL_LOCK
- [x] **CONC-M7**: LVGL mutex uses debug timeout (5s) to detect deadlocks

### BLE/NimBLE (P2)

- [x] **CONC-M5**: Connection mutex timeout failures are logged
- [x] **CONC-M6**: Discovered devices cache bounded with LRU eviction

### Infrastructure (P2)

- [x] **CONC-M8**: Audio I2S write uses reasonable timeout (not portMAX_DELAY)
- [x] **CONC-M9**: Mutex ordering documented in docs/CONCURRENCY.md

### Memory Optimization (P3)

- [x] **MEM-H1**: Bytes COW copy uses pool or arena allocator
- [x] **MEM-H2**: Packet Object uses pool allocator (16-32 slots)
- [x] **MEM-H3**: Packet fixed-size members use inline buffers (save ~150 bytes/packet)
- [x] **MEM-H4**: PacketReceipt allocation is lazy (only for non-NONE types)
- [x] **MEM-L1**: toHex reserves string capacity upfront

### Concurrency Hardening (P3)

- [x] **CONC-H4**: BLE shutdown waits for active operations to complete
- [x] **CONC-M4**: Soft reset fully releases NimBLE state (or uses hard recovery)
- [x] **CONC-L1**: Native GAP handler volatile usage is documented
- [x] **CONC-L2**: 50ms error recovery delay is documented with rationale
- [x] **CONC-L4**: Debug builds use mutex timeout to detect stuck tasks

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| MEM-M1 | Phase 7 | Complete |
| MEM-M2 | Phase 7 | Complete |
| MEM-M3 | Phase 8 | Complete |
| CONC-M1 | Phase 7 | Complete |
| CONC-M2 | Phase 7 | Complete |
| CONC-M3 | Phase 7 | Complete |
| CONC-M5 | Phase 7 | Complete |
| CONC-M6 | Phase 7 | Complete |
| CONC-M7 | Phase 7 | Complete |
| CONC-M8 | Phase 7 | Complete |
| CONC-M9 | Phase 7 | Complete |
| MEM-H1 | Phase 8 | Complete |
| MEM-H2 | Phase 8 | Complete |
| MEM-H3 | Phase 8 | Complete |
| MEM-H4 | Phase 7 | Complete |
| MEM-L1 | Phase 8 | Complete |
| CONC-H4 | Phase 8 | Complete |
| CONC-M4 | Phase 8 | Complete |
| CONC-L1 | Phase 8 | Complete |
| CONC-L2 | Phase 8 | Complete |
| CONC-L4 | Phase 8 | Complete |

**Coverage:**
- v1.2 requirements: 21 total
- Shipped: 21
- Dropped: 0

---

## Milestone Summary

**Shipped:** 21 of 21 v1.2 requirements

**Adjusted:**
- MEM-H4 (PacketReceipt lazy allocation) was completed in Phase 7 alongside MEM-M2

**Dropped:** None

---
*Archived: 2026-01-24 as part of v1.2 milestone completion*
