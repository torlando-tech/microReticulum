---
phase: 05-synthesis
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/05-synthesis/BACKLOG.md
autonomous: true

must_haves:
  truths:
    - "All 31 issues from Phases 3-4 are present in the backlog (13 from Phase 3 + 18 from Phase 4)"
    - "Each issue has a numeric WSJF priority score"
    - "Issues are ordered by WSJF score descending"
    - "Each issue has a fix recommendation"
  artifacts:
    - path: ".planning/phases/05-synthesis/BACKLOG.md"
      provides: "Prioritized stability backlog"
      contains: "## Issue Catalog"
  key_links:
    - from: "BACKLOG.md"
      to: "03-AUDIT.md"
      via: "Issue references with normalized IDs"
      pattern: "MEM-(H|M|L)[0-9]+"
    - from: "BACKLOG.md"
      to: "04-SUMMARY.md"
      via: "Issue references with normalized IDs"
      pattern: "CONC-(H|M|L)[0-9]+"
---

<objective>
Consolidate all findings from Phases 3-4 into a single prioritized BACKLOG.md document with WSJF scoring.

Purpose: Deliver the final audit artifact (DLVR-01) - a prioritized backlog that enables incremental stability improvements
Output: BACKLOG.md with 31 issues (13 from Phase 3 + 18 from Phase 4), WSJF scores, and fix recommendations ordered by priority
</objective>

<execution_context>
@/home/tyler/.claude/get-shit-done/workflows/execute-plan.md
@/home/tyler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-synthesis/05-RESEARCH.md
@.planning/phases/03-memory-allocation-audit/03-AUDIT.md
@.planning/phases/04-concurrency-audit/04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BACKLOG.md with all 31 issues</name>
  <files>.planning/phases/05-synthesis/BACKLOG.md</files>
  <action>
Create BACKLOG.md using the structure from 05-RESEARCH.md:

1. **YAML Frontmatter:**
   - type: backlog
   - version: 1.0
   - generated: [today's date]
   - source_phases: [3, 4]
   - issue_count: 31
   - severity_distribution: critical: 0, high: 9, medium: 13, low: 9

2. **Executive Summary (3-4 sentences):**
   - Total issues: 31 (0 Critical, 9 High, 13 Medium, 9 Low)
   - Top priority: TWDT configuration (P1)
   - Recommended sprint allocation based on WSJF tiers

3. **Priority Summary Table:**
   - Count by priority tier (P1/P2/P3/P4)
   - Effort range per tier
   - Sprint recommendations

4. **Issue Catalog Table:**
   Columns: ID | Source | Severity | Effort | WSJF | Title | Priority

   For each issue, calculate WSJF = Severity Score / Effort Score:
   - Severity: Critical=10, High=7, Medium=4, Low=1
   - Effort: Trivial=1, Low=2, Medium=5, High=8

   Sort by WSJF descending (highest priority first).

5. **Issues by Priority Tier:**
   Group issues into P1 (>=3.0), P2 (1.5-2.99), P3 (0.5-1.49), P4 (<0.5)
   For each tier, create a table with ID, Issue, Effort, Source columns.

6. **Issue Detail Cards:**
   For each of the 31 issues, create a card with:
   - **ID**: Unified ID (MEM-H1, MEM-M2, CONC-H1, etc.)
   - **Source**: Phase 3 or Phase 4 audit report
   - **Severity**: High/Medium/Low with score
   - **Effort**: T-shirt size with score
   - **WSJF Score**: Calculated value
   - **Problem**: 1-2 sentence description
   - **Location**: File:line references
   - **Fix Recommendation**: Brief guidance (not full implementation)
   - **Verification**: How to confirm the fix works

**Issue ID Mapping:**
From Phase 3 (Memory Audit):
- MEM-H1: H1 (Bytes COW) - High, Medium effort
- MEM-H2: H2 (Packet Object) - High, High effort
- MEM-H3: H3 (Packet 9 Bytes) - High, Medium effort
- MEM-H4: H4 (PacketReceipt) - High, Low-Medium effort
- MEM-H5: H5 (Resource vectors) - High, Low effort
- MEM-M1: M1 (Bytes newData) - Medium, Low effort
- MEM-M2: M2 (PacketReceipt default) - Medium, Low effort
- MEM-M3: M3 (DynamicJsonDocument) - Medium, Low effort
- MEM-M4: M4 (Duplicate static) - Medium, Trivial effort
- MEM-L1: L1 (toHex) - Low, Trivial effort
- MEM-L2: L2 (BLEFragmenter) - Low, Low effort
- MEM-L3: L3 (Fixed doc size) - Low, Low effort
- MEM-L4: L4 (std::map) - Low, Low effort

From Phase 4 (Concurrency Audit):
- CONC-H1: TASK-01 (TWDT) - High, Low effort
- CONC-H2: TASK-02 (LXStamper) - High, Low effort
- CONC-H3: NIMBLE-01 (Pending queues) - High, Low effort
- CONC-H4: NIMBLE-02 (Shutdown) - High, Medium effort
- CONC-M1: LVGL-01 (SettingsScreen) - Medium, Low effort
- CONC-M2: LVGL-02 (ComposeScreen) - Medium, Low effort
- CONC-M3: LVGL-03 (AnnounceListScreen) - Medium, Low effort
- CONC-M4: NIMBLE-03 (Soft reset) - Medium, Medium effort
- CONC-M5: NIMBLE-04 (Mutex timeout) - Medium, Low effort
- CONC-M6: NIMBLE-05 (Cache eviction) - Medium, Low effort
- CONC-M7: TASK-03 (LVGL portMAX_DELAY) - Medium, Low effort
- CONC-M8: TASK-04 (I2S portMAX_DELAY) - Medium, Low effort
- CONC-M9: MUTEX-01 (No ordering enforcement) - Medium, Low effort
- CONC-L1: NIMBLE-06 (Volatile usage) - Low, Trivial effort
- CONC-L2: NIMBLE-07 (50ms delay) - Low, Trivial effort
- CONC-L3: TASK-05 (Link watchdog) - Low, Medium effort
- CONC-L4: MUTEX-02 (portMAX_DELAY masking) - Low, Low effort

Note: Phase 3 has exactly 13 issues (5 High, 4 Medium, 4 Low). Phase 4 has exactly 18 issues (4 High, 9 Medium, 5 Low). Total: 31 issues.

**Do NOT:**
- Include full implementation code (keep recommendations brief)
- Change severity ratings without explicit justification
- Merge similar issues (keep them separate for tracking)
- Include Phase 1-2 instrumentation (those were tools, not issues)
  </action>
  <verify>
- Count issues in BACKLOG.md: should be exactly 31 (13 from Phase 3 + 18 from Phase 4)
- Verify all issues have WSJF score calculated
- Verify issues are sorted by WSJF descending in catalog table
- Verify each priority tier has correct WSJF range
  </verify>
  <done>
- BACKLOG.md exists with all issues from Phase 3 and Phase 4
- Each issue has Severity, Effort, WSJF score, and fix recommendation
- Issues sorted by WSJF with highest priority first
- Priority tiers (P1/P2/P3/P4) correctly assigned
  </done>
</task>

<task type="auto">
  <name>Task 2: Update STATE.md and commit</name>
  <files>.planning/STATE.md</files>
  <action>
1. Update STATE.md:
   - Current Position: Phase 5 of 5 COMPLETE
   - Status: Synthesis complete, BACKLOG.md delivered
   - Add entry in Accumulated Context > Phase 5 Synthesis Findings
   - Clear "Pending Todos" (milestone complete)
   - Update Session Continuity

2. Git commit the backlog and state update:
   ```bash
   git add .planning/phases/05-synthesis/BACKLOG.md .planning/STATE.md
   git commit -m "docs(05): create prioritized stability backlog

   Phase 05: Synthesis
   - 31 issues consolidated from Phases 3-4
   - WSJF priority scoring applied
   - Backlog ordered by priority (P1 > P2 > P3 > P4)
   - Ready for implementation sprints"
   ```
  </action>
  <verify>
- STATE.md shows Phase 5 complete
- Git log shows commit with backlog
  </verify>
  <done>
- STATE.md updated to reflect Phase 5 completion
- BACKLOG.md committed to repository
- Milestone 1 (Stability Audit) is complete
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **Issue Count:**
   ```bash
   grep -c "^### " .planning/phases/05-synthesis/BACKLOG.md | grep -E "MEM-|CONC-"
   # Should be ~31 issue detail cards
   ```

2. **WSJF Presence:**
   ```bash
   grep "WSJF" .planning/phases/05-synthesis/BACKLOG.md | head -5
   # Should show WSJF scores in catalog and cards
   ```

3. **Priority Tiers:**
   ```bash
   grep -E "^## Priority [1-4]" .planning/phases/05-synthesis/BACKLOG.md
   # Should show 4 priority tier sections
   ```

4. **Source References:**
   ```bash
   grep -E "03-AUDIT|04-SUMMARY" .planning/phases/05-synthesis/BACKLOG.md
   # Should reference source audit documents
   ```
</verification>

<success_criteria>
- [ ] BACKLOG.md contains all 31 issues (13 from Phase 3 + 18 from Phase 4)
- [ ] Each issue has Severity Score, Effort Score, and WSJF Score
- [ ] Issues sorted by WSJF descending (highest priority first)
- [ ] Priority tiers (P1/P2/P3/P4) match WSJF thresholds from research
- [ ] Each issue has a brief fix recommendation
- [ ] STATE.md updated to show Phase 5 complete
- [ ] Changes committed to git
</success_criteria>

<output>
After completion, create `.planning/phases/05-synthesis/05-01-SUMMARY.md` with:
- Objective accomplished
- Issues consolidated and scored
- Priority distribution (P1/P2/P3/P4 counts)
- Milestone status (complete)
- Next steps (implementation sprints or milestone closure)
</output>
